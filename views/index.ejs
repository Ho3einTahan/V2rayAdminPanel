<html lang="fa">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Dashboard</title>
    <!-- Bootstrap CSS-->
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="vendor/fontawesome/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles-->
    <link href="css/font-face.css" rel="stylesheet" media="all">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/theme.css" rel="stylesheet" media="all">

    <style>
        body {
            font-family: 'Vazir', sans-serif;
            background-color: #f7f7ff;
            margin: 0;
            padding: 0;
        }

        .header-desktop3, .header-mobile {
            background-color: #2d3748;
        }

        .account-wrap .account-item .image img {
            border-radius: 50%;
            border: 2px solid #fff;
            padding: 2px;
        }

        .account-wrap .account-dropdown .info .content h5 {
            color: #fff;
            font-weight: bold;
        }

        .header__tool {
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .account-dropdown__item a:hover {
            background-color: transparent !important;
            color: inherit !important;
        }

        .account-dropdown__item a i {
            color: #5a67d8;
            margin-left: 10px;
        }

        .page-content--bgf7 {
            background-color: #f7f7ff;
            padding-top: 20px;
        }

        .au-breadcrumb2 {
            background-color: #edf2f7;
            padding: 20px 0;
        }

        .au-form-icon--sm input {
            background-color: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 50px;
            padding-right: 40px;
        }

        .au-btn--submit2 {
            background-color: transparent;
            border: none;
            color: #2d3748;
        }

        .au-btn--submit2 i {
            font-size: 20px;
        }

        .table-responsive-data2 {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            background-color: #fff;
            overflow-x: auto; /* Add horizontal scroll */
            width: 100%; /* Make sure it takes full width */
        }

        .table th, .table td {
            text-align: center;
            vertical-align: middle;
            white-space: nowrap; /* Prevent text wrapping */
        }

        .table th h5, .table td h6 {
            color: #2d3748;
        }

        .table-data-feature {
            display: flex;
            justify-content: center;
        }

        .table-data-feature a.item {
            margin: 0 5px;
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.3s;
        }

        .table-data-feature a.item:hover {
            background-color: #edf2f7;
        }

        #user_Not_Found {
            color: #e53e3e;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
        }

        .alert-dismissible {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-circle {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }

        .active {
            background-color: #28a745; /* سبز */
        }

        .inactive {
            background-color: #dc3545; /* قرمز */
        }

        .table td.mac-address {
            max-width: 120px; /* حداکثر عرض برای سلول مک آدرس */
            white-space: nowrap; /* جلوگیری از شکستن متن به خطوط جدید */
            overflow: hidden; /* مخفی کردن بخش اضافی متن */
            text-overflow: ellipsis; /* اضافه کردن سه نقطه در انتهای متن */
        }

    </style>

</head>

<body class="animsition">

    <% if (success.length > 0) { %>
        <% success.forEach(data => { %>
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <%= data %>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        <% }) %>
    <% } %>
    
    <div class="page-wrapper">
        <!-- HEADER DESKTOP-->
        <header class="header-desktop3 d-none d-lg-block">
            <div class="section__content section__content--p35">
                <div class="header3-wrap">
                    <div class="header__tool">
                        <div class="account-wrap" style="margin-left: 24px;">
                            <div class="account-item account-item--style1 clearfix js-item-menu">
                                <div class="image">
                                    <img src="/images/icon/me.png" alt="Hosein Tahan" />
                                </div>
                                <div class="account-dropdown js-dropdown">
                                    <div class="info clearfix">
                                        <div class="image">
                                            <a href="#">
                                                <img src="/images/icon/me.png" alt="Hosein Tahan" />
                                            </a>
                                        </div>
                                        <div class="content">
                                            <h5 class="name">
                                                <a href="#">Hosein Tahan</a>
                                            </h5>
                                            <span class="email">hoseintahan84@gmail.com</span>
                                        </div>
                                    </div>
                                    <div class="account-dropdown__body">
                                        <div class="account-dropdown__item">
                                            <a href="/user/add">
                                                <i class="zmdi zmdi-account-add"></i>افزودن کاربر</a>
                                        </div>
                                        <div class="account-dropdown__item">
                                            <a href="/servers">
                                                <i class="zmdi zmdi-cloud-upload"></i>مدیریت سرور ها</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>   
                </div>
            </div>
        </header>
        <!-- END HEADER DESKTOP-->

        <!-- HEADER MOBILE-->
        <header class="header-mobile header-mobile-2 d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="index.html">
                            <img src="images/icon/logo-white.png" alt="CoolAdmin" />
                        </a>
                        <button class="hamburger hamburger--slider" type="button">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </header>
        <!-- END HEADER MOBILE -->

        <!-- PAGE CONTENT-->
        <div class="page-content--bgf7">
            <!-- BREADCRUMB-->
            <section class="au-breadcrumb2">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="au-breadcrumb-content">
                                <form class="au-form-icon--sm">
                                    <button class="au-btn--submit2" type="button">
                                        <i class="zmdi zmdi-search"></i>
                                    </button>
                                    <input class="au-input--w300 au-input--style2" id="searchBar" type="text" placeholder=" جست و جوی کاربران (شماره تلفن) ...">
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- END BREADCRUMB-->

            <!-- DATA TABLE-->
            <section class="p-t-20">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">                
                            <div class="table-responsive table-responsive-data2">
                                <table class="table table-data2" id="userTable">
                                    <thead>
                                        <tr>
                                            <th><h5>مک آدرس</h5></th>
                                            <th><h5>نام کاربر</h5></th>
                                            <th><h5>شماره کاربر</h5></th>
                                            <th><h5>تاریخ شروع سرویس</h5></th>
                                            <th><h5>تاریخ پایان سرویس</h5></th>
                                            <th><h5>تعداد کاربران (چند کاربره)</h5></th>
                                            <th><h5>وضعیت سرویس</h5></th>
                                            <th><h5>عملیات</h5></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% data.forEach(user => { %>
                                        <tr class="tr-shadow">
                                            <td class="mac-address"><h6><%= user.macAddress %></h6></td>
                                            <td><%= user.userName %></td>
                                            <td>
                                                <span class="block-email"><h6><%= user.phoneNumber %></h6></span>
                                            </td>
                                            <td class="desc"><h6><%= user.startServiceDate %></h6></td>
                                            <td class="desc"><h6><%= user.endServiceDate %></h6></td>
                                            <td><h6><%= user.multiUser %> کاربره</h6></td>
                                            <td>
                                                <div>
                                                    <% if (user.status==true) { %>
                                                        <span class="status-circle active"></span>
                                                        <% } else { %>
                                                        <span class="status-circle inactive"></span>
                                                    <% } %>                                                     
                                                </div>
                                            </td>
                                            <td>
                                                <div class="table-data-feature">
                                                    <a class="item btn btn-sm btn-solid-dark" href="http://localhost:3000/user/edit/<%= user.phoneNumber %>">
                                                        <i class="zmdi zmdi-edit" style="color:#ff7300;"></i>
                                                    </a>
                                                    <a class="item btn btn-sm btn-solid-dark" href="http://localhost:3000/user/delete/<%= user.phoneNumber %>">
                                                        <i class="zmdi zmdi-delete" style="color:#FF1700;"></i>
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                        <% }) %>
                                    </tbody>
                                </table>

                                <center>
                                    <h2 style="display: none;" id="user_Not_Found">کاربر مورد نظر یافت نشد</h2>
                                </center>

                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- END DATA TABLE-->
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Jquery JS-->
    <script src="vendor/jquery-3.2.1.min.js"></script>
    <!-- Vendor JS       -->
    <script src="vendor/slick/slick.min.js"></script>
    <script src="vendor/wow/wow.min.js"></script>
    <script src="vendor/animsition/animsition.min.js"></script>
    <script src="vendor/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <script src="vendor/counter-up/jquery.waypoints.min.js"></script>
    <script src="vendor/counter-up/jquery.counterup.min.js"></script>
    <script src="vendor/circle-progress/circle-progress.min.js"></script>
    <script src="vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="vendor/chartjs/Chart.bundle.min.js"></script>
    <script src="vendor/select2/select2.min.js"></script>

    <!-- Main JS-->
    <script src="js/main.js"></script>

    <script>
        var searchBar = document.getElementById('searchBar');
        var table = document.getElementById('userTable');
        var user_Not_Found = document.getElementById('user_Not_Found');
        var rows = table.getElementsByTagName('tr');

        searchBar.addEventListener('keyup', function() {
            var filter = searchBar.value.toLowerCase();
            var found = false;

            for (var i = 1; i < rows.length; i++) {
                var td = rows[i].getElementsByTagName('td')[2];
                if (td) {
                    var txtValue = td.textContent || td.innerText;
                    if (txtValue.toLowerCase().indexOf(filter) > -1) {
                        rows[i].style.display = '';
                        found = true;
                    } else {
                        rows[i].style.display = 'none';
                    }
                }
            }

            if (found) {
                user_Not_Found.style.display = 'none';
            } else {
                user_Not_Found.style.display = '';
            }
        });
    </script>

</body>

</html>
